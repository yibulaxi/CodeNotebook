# xz最大压缩

`nice -n 19 xz -z -9 -e --lzma2=dict=1024MiB --block-size=512M --threads=23 --memlimit=64G -k -v <要压缩的文件>` 

- `nice -n 19`: 最低优先级，Windows 上是 `START /LOW`。
- `-z`/`--compress`: 表示**压缩**（默认情况下，xz 执行压缩操作）。
- `-9`: 设置**压缩级别**为最大（ 9 是 xz 中的最高压缩级别，默认 6 ）。
- `-e`/`--extreme`: 启用**极限压缩**模式（提供额外的压缩比提升，默认不开）。
- `--lzma2=dict=1024MiB`: 指定使用 LZMA2 **算法**（默认就是了），dict= 是字典大小（默认字典大小取决于压缩等级）。
- `--block-size=512M`: 在多线程模式下，**每个线程处理一个块的大小**（不写就自动，默认块大小大约是 2–4 倍字典大小）。
- `--threads=23`: 利用**多少个核心**进行并行压缩（默认值 0 也就是自动检测）。
- `--memlimit=64G`: 设置**最大内存**限制，算法需要的内存超过这个限制，会报错或自动降级（默认值 0 无限制）。
- `-k`/`--keep`: 当使用 --keep 时，xz 在压缩文件后**不会删除原始文件**，而是保留原始文件。默认情况下，xz 在压缩完成后会删除原始文件（除非使用 -k）。
- `-v`/`--verbose`: 显示**详细信息**，比如压缩比、内存使用、进度等（默认关闭）。

## 压缩等级字典大小

0. 256 KiB
1. 1 MiB
2. 2 MiB
3. 4 MiB
4. 4 MiB
5. 8 MiB
6. 8 MiB（默认等级，和 -5 字典相同，但参数更激进，压缩比更高，速度更慢）
7. 16 MiB
8. 32 MiB
9. 64 MiB

## 提示

- 压缩比：-e 模式的目标是提供更高的压缩比。在许多情况下，启用该模式会使压缩比比 -9 高，但压缩速度较慢。
- 内存限制：xz 会根据给定的内存限制（--memlimit）使用更多的内存来提升压缩效率。如果你的机器内存足够大，可以尝试更高的内存限制（比如 256GB 或更高），这将允许 xz 使用更大的字典来进一步提高压缩比。
  - 启用极限模式时，内存使用和压缩时间都会显著增加。如果你的机器内存充足并且可以容忍较长的压缩时间，那么可以尝试使用 -e。
- 压缩时间：请注意，最大限度的压缩会导致非常长的压缩时间，特别是在非常大的文件或目录上。使用更多的内存和多核处理器将有助于加速这一过程，但整体时间可能仍然会较长。
- 压缩比与速度：虽然 xz 的最大压缩级别可以获得非常高的压缩比，但压缩速度会较慢。如果你更重视速度，可以选择较低的压缩级别（例如 6 或 7），这会在速度和压缩比之间达到一个平衡。
